(this["webpackJsonpacademy-weather-forecast"]=this["webpackJsonpacademy-weather-forecast"]||[]).push([[0],{23:function(e,t,a){},24:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(18),i=a.n(c),s=(a(23),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,45)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))}),o=(a(24),a(4)),l=a(5),d=a(7),u=a(6),h=[{id:"1",name:"\u0421\u0430\u043c\u0430\u0440\u0430",latitude:53.195873,longitude:50.100193},{id:"2",name:"\u0422\u043e\u043b\u044c\u044f\u0442\u0442\u0438",latitude:53.507836,longitude:49.420393},{id:"3",name:"\u0421\u0430\u0440\u0430\u0442\u043e\u0432",latitude:51.533557,longitude:46.034257},{id:"4",name:"\u041a\u0430\u0437\u0430\u043d\u044c",latitude:55.796127,longitude:49.106405},{id:"5",name:"\u041a\u0440\u0430\u0441\u043d\u043e\u0434\u0430\u0440",latitude:45.03547,longitude:38.975313}],f=a(0),j=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).change=function(e){var t=h.find((function(t){return t.id===e.target.value}));n.setState((function(e,a){return{currentCity:t}})),console.log("Chosen city: "+(null===t||void 0===t?void 0:t.name)),n.props.onChange(t)},n.state={currentCity:null},n}return Object(l.a)(a,[{key:"render",value:function(){var e=h.map((function(e){return Object(f.jsx)("option",{value:e.id,children:e.name},e.id)}));return Object(f.jsxs)("select",{className:"awf-field",onChange:this.change,children:[Object(f.jsx)("option",{value:"",disabled:!0,selected:!0,hidden:!0,children:"Select city"}),e]})}}]),a}(r.a.Component),w=a(3),b="https://api.openweathermap.org/data/2.5/onecall?units=metric&lat={lat}&lon={lon}&appid={API key}",m="https://api.openweathermap.org/data/2.5/onecall/timemachine?units=metric&lat={lat}&lon={lon}&dt={time}&appid={API key}",v=a(9),g=a.n(v);var p=function(e){return e.weather?Object(f.jsxs)("div",{className:"awf-weather-card _filled",children:[Object(f.jsx)("div",{className:"awf-weather-card__date",children:(t=e.weather.dt,t?new Date(1e3*t).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}):"")}),Object(f.jsx)("div",{className:"awf-weather-card__icon",children:e.weather.icon}),Object(f.jsxs)("div",{className:"awf-weather-card__temp",children:[e.weather.temp&&e.weather.temp>0?"+":"-",e.weather.temp,"\xb0"]})]}):Object(f.jsxs)("div",{className:"awf-weather-card",children:[Object(f.jsx)("div",{className:"awf-weather-icon"}),Object(f.jsx)("p",{className:"awf-label",children:"Fill in all the fields and the weather will be displayed"})]});var t};var O=function(e){var t=Object(n.useState)([]),a=Object(w.a)(t,2),r=a[0],c=a[1];function i(e,t,a,n){var r=new URL(e),c=r.searchParams;return c.set("lat",t.toString()),c.set("lon",a.toString()),n&&c.set("dt",(n.getTime()/1e3).toString()),c.set("appid","40537f711a3e40204f77fbad85878b95"),r.search=c.toString(),console.log("url: "+r),r.toString()}function s(t){if(console.log("Response: "+t.data),e.weekly){if(Array.isArray(t.data.daily)&&t.data.daily.length>0){var a=[];t.data.daily.forEach((function(e){var t={temp:e.temp.max,dt:e.dt,icon:Array.isArray(e.weather)&&e.weather.length>0?e.weather[0].icon:""};a.push(t)})),c(a)}}else if(t.data.current){var n={temp:t.data.current.temp,dt:t.data.current.dt,icon:Array.isArray(t.data.current.weather)&&t.data.current.weather.length>0?t.data.current.weather[0].icon:""};c([n])}}if(Object(n.useEffect)((function(){var t,a;console.log("WeatherPanel Use effect hook worked"),r.length||((null===e||void 0===e?void 0:e.city)&&e.date&&(t=e.city,a=e.date,g.a.get(i(m,t.latitude,t.longitude,a)).then((function(e){s(e)}),(function(e){console.log("Error occurred: "+e)}))),(null===e||void 0===e?void 0:e.city)&&e.weekly&&function(e){g.a.get(i(b,e.latitude,e.longitude)).then((function(e){s(e)}),(function(e){console.log("Error occurred: "+e)}))}(e.city))})),Array.isArray(r)&&r.length>0){if(1===r.length)return Object(f.jsx)("div",{className:"awf-weather-report",children:Object(f.jsx)(p,{weather:r[0]})});var o=null===r||void 0===r?void 0:r.map((function(e){return Object(f.jsx)(p,{weather:e})}));return Object(f.jsxs)("div",{className:"awf-weather-report",children:[Object(f.jsx)("button",{className:"awf-weather-report_button _left"}),o.slice(0,3),Object(f.jsx)("button",{className:"awf-weather-report_button _right"})]})}return Object(f.jsx)("div",{className:"awf-weather-report _empty",children:Object(f.jsx)(p,{})})},y=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={city:void 0},n}return Object(l.a)(a,[{key:"handleCityChange",value:function(e){this.setState({city:e})}},{key:"render",value:function(){var e=this;return Object(f.jsxs)("div",{className:"awf-weekly-forecast awf-forecast-card",children:[Object(f.jsx)("h1",{className:"awf-forecast-card_label",children:"7 Days Forecast"}),Object(f.jsx)(j,{onChange:function(t){return e.handleCityChange(t)}}),Object(f.jsx)(O,{city:this.state.city,weekly:!0})]})}}]),a}(r.a.Component);var x=function(){var e=Object(n.useState)(void 0),t=Object(w.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(void 0),i=Object(w.a)(c,2),s=i[0],o=i[1],l=(new Date).toISOString().substring(0,10);return Object(f.jsxs)("div",{className:"awf-past-forecast awf-forecast-card",children:[Object(f.jsx)("h1",{className:"awf-forecast-card_label",children:"Forecast for a Date in the Past"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(j,{onChange:function(e){return r(e)}}),Object(f.jsx)("input",{className:"awf-field",type:"date",max:l,onChange:function(e){return o(e.target.valueAsDate)}})]}),Object(f.jsx)(O,{city:a,date:s,weekly:!1})]})};var N=function(){return Object(f.jsxs)("div",{className:"awf-forecast",children:[Object(f.jsx)(y,{}),Object(f.jsx)(x,{})]})};i.a.render(Object(f.jsx)(N,{}),document.getElementById("root")),s()}},[[44,1,2]]]);
//# sourceMappingURL=main.96fc213f.chunk.js.map